(self.AMP=self.AMP||[]).push({n:"amp-youtube",v:"1490899213109",f:(function(AMP){var k;(function(a){return"undefined"!=typeof window&&window===a?a:"undefined"!=typeof global?global:a})(this);function n(a,c){function b(){}b.prototype=c.prototype;a.prototype=new b;a.prototype.constructor=a;for(var d in c)if(Object.defineProperties){var e=Object.getOwnPropertyDescriptor(c,d);e&&Object.defineProperty(a,d,e)}else a[d]=c[d]}var p="";
function q(a){var c=a||self,b;if(c.AMP_MODE)b=c.AMP_MODE;else{b=c;if(b.context&&b.context.mode)b=b.context.mode;else{var d=r(b.location.originalHash||b.location.hash),e=r(b.location.search);p||(p=b.AMP_CONFIG&&b.AMP_CONFIG.v?b.AMP_CONFIG.v:"011490899213109");b={localDev:!1,development:!("1"!=d.development&&!b.AMP_DEV_MODE),filter:d.filter,minified:!0,lite:void 0!=e.amp_lite,test:!1,log:d.log,version:"1490899213109",rtvVersion:p}}b=c.AMP_MODE=b}return b}
function r(a){var c=Object.create(null);if(!a)return c;if(0==a.indexOf("?")||0==a.indexOf("#"))a=a.substr(1);for(var b=a.split("&"),d=0;d<b.length;d++){var e=b[d],f=e.indexOf("="),g,h;-1!=f?(g=decodeURIComponent(e.substring(0,f)).trim(),h=decodeURIComponent(e.substring(f+1)).trim()):(g=decodeURIComponent(e).trim(),h="");g&&(c[g]=h)}return c};var t=Object.prototype.toString;Date.now();self.log=self.log||{user:null,dev:null};var v=self.log;function w(){if(v.user)return v.user;throw Error("failed to call initLogConstructor");};function x(a){var c,b,d=c||function(a){return a},e=a.dataset;a=Object.create(null);var f=b?b:/^param(.+)/,g;for(g in e){var h=g.match(f);if(h){var l=h[1][0].toLowerCase()+h[1].substr(1);a[d(l)]=e[g]}}return a};function y(a,c){a=a.__AMP_TOP||a;return a.services&&a.services[c]&&a.services[c].obj}function z(a,c){var b=A(a);return b&&b.services&&b.services[c]&&b.services[c].obj}function B(a,c){var b;a=a.__AMP_TOP||a;return C(a,a,c,void 0,b?b:void 0)}function D(a){var c=E;a=F(a);C(A(a),a,"video-manager",c)}function F(a){return a.nodeType?B((a.ownerDocument||a).defaultView,"ampdoc").getAmpDoc(a):a}function A(a){a=F(a);return a.isSingleDoc()?a.win:a}
function C(a,c,b,d,e){var f=a.services;f||(f=a.services={});var g=f;(a=g[b])||(a=g[b]={obj:null,promise:null,resolve:null,build:null});a.obj||(a.obj=a.build?a.build():d?new d(c):e(c),a.resolve&&a.resolve(a.obj));return a.obj};var G,H="Webkit webkit Moz moz ms O o".split(" ");function I(a,c){for(var b in c){var d=a,e=c[b],f;f=d.style;var g=b;G||(G=Object.create(null));var h=G[g];if(!h){h=g;if(void 0===f[g]){var l;l=g;l=l.charAt(0).toUpperCase()+l.slice(1);a:{for(var u=0;u<H.length;u++){var m=H[u]+l;if(void 0!==f[m]){l=m;break a}}l=""}void 0!==f[l]&&(h=l)}G[g]=h}(f=h)&&(d.style[f]=e)}};function J(a,c,b){function d(a){try{return h.call(f,a)}catch(m){throw self.reportError(m),m;}}var e,f=this,g=a,h=b,l=e||!1;g.addEventListener(c,d,l);return function(){g&&g.removeEventListener(c,d,l);d=g=h=null}}function K(a,c){function b(a){try{e(a)}catch(h){throw self.reportError(h),h;}finally{f()}}var d=a,e=c,f;f=function(){d&&d.removeEventListener("load",b,!1);e=b=d=null};d.addEventListener("load",b,!1);return f}function L(a){var c,b,d=new Promise(function(c){b=K(a,c)});return M(d,b,c)}
function M(a,c,b){var d=void 0,e;e=void 0===b?a:y(self,"timer").timeoutPromise(b||0,a);c&&e.then(c,c);d&&e.then(d,d);return e};function E(a){this.b=a;this.f=null;this.A=!1}E.prototype.register=function(a){var c=a;c.registerAction("play",c.play.bind(c,!1));c.registerAction("pause",c.pause.bind(c));c.registerAction("mute",c.mute.bind(c));c.registerAction("unmute",c.unmute.bind(c));if(a.element.hasAttribute("autoplay")&&a.supportsPlatform()){this.f=this.f||[];var b=new N(this.b,a);O(this,b);this.f.push(b)}};
function O(a,c){J(c.video.element,"amp:video:visibility",function(){c.updateVisibility()});if(!a.A){var b=function(){for(var b=0;b<a.f.length;b++)a.f[b].updateVisibility()},d=z(a.b,"viewport");d.onScroll(b);d.onChanged(b);a.A=!0}}
function N(a,c){var b=this;this.b=a;this.video=c;this.C=null;this.B=this.c=this.u=!1;this.o=B(a.win,"vsync");this.s=P.bind(null,a.win,q(a.win).lite);a=c.element;this.i=a.hasAttribute("autoplay");L(a).then(function(){b.updateVisibility();b.u=!0;b.c&&b.i&&Q(b)});this.updateVisibility();this.i&&R(this)}function R(a){a.video.isInteractive()&&a.video.hideControls();a.s().then(function(c){!c&&a.video.isInteractive()?a.video.showControls():(a.video.mute(),a.video.isInteractive()&&S(a))})}
function S(a){function c(b){a.o.mutate(function(){d.classList.toggle("amp-video-eq-play",b)})}function b(){this.B=!0;this.video.showControls();this.video.unmute();f();g();h();d.remove();e.remove()}a.video.hideControls();var d=T(a),e=U(a);a.o.mutate(function(){a.video.element.appendChild(d);a.video.element.appendChild(e)});var f=J(e,"click",b.bind(a)),g=J(a.video.element,"pause",c.bind(a,!1)),h=J(a.video.element,"play",c.bind(a,!0))}
function Q(a){!a.B&&z(a.b,"viewer").isVisible()&&a.s().then(function(c){c&&(a.c?a.video.play(!0):a.video.pause())})}
function T(a){var c=a.b.win.document,b=c.createElement("i-amp-video-eq");b.classList.add("amp-video-eq");for(var d=1;4>=d;d++){var e=c.createElement("div");e.classList.add("amp-video-eq-col");for(var f=1;2>=f;f++){var g=c.createElement("div");g.classList.add("amp-video-eq-"+d+"-"+f);e.appendChild(g)}b.appendChild(e)}var h=y(a.b.win,"platform");h.isIos()&&b.setAttribute("unpausable","");return b}
function U(a){a=a.b.win.document.createElement("i-amp-video-mask");a.classList.add("i-amphtml-fill-content");return a}N.prototype.updateVisibility=function(){function a(){b.c!=d&&b.u&&b.i&&Q(b)}function c(){if(b.video.isInViewport()){var a=b.video.element.getIntersectionChangeEntry(),c=a.intersectionRatio,d="number"===typeof c&&isFinite(c)?100*a.intersectionRatio:0;b.c=75<=d}else b.c=!1}var b=this,d=this.c;this.o.run({measure:c,mutate:a})};var V=null;
function P(a,c){if(V)return V;if(c)return V=Promise.resolve(!1);var b=a.document.createElement("video");b.setAttribute("muted","");b.setAttribute("playsinline","");b.setAttribute("webkit-playsinline","");b.muted=!0;b.playsinline=!0;b.webkitPlaysinline=!0;b.setAttribute("height","0");b.setAttribute("width","0");I(b,{position:"fixed",top:"0",width:"0",height:"0",opacity:"0"});try{var d=b.play();d&&d.catch&&d.catch(function(){})}catch(e){}return V=Promise.resolve(!b.paused)};function W(a){AMP.BaseElement.call(this,a);this.h=0;this.g=null;this.j=!1;this.w=this.l=this.m=this.a=null}n(W,AMP.BaseElement);k=W.prototype;k.preconnectCallback=function(a){this.preconnect.url(X(this));this.preconnect.url("https://s.ytimg.com",a);this.preconnect.url("https://i.ytimg.com",a)};k.isLayoutSupported=function(a){return"fixed"==a||"fixed-height"==a||"responsive"==a||"fill"==a||"flex-item"==a};k.renderOutsideViewport=function(){return.75};
k.viewportCallback=function(a){this.element.dispatchCustomEvent("amp:video:visibility",{visible:a})};k.buildCallback=function(){var a=this;this.g=Y(this);this.l=new Promise(function(c){a.w=c});this.getPlaceholder()||aa(this);D(this.element);z(this.element,"video-manager").register(this)};
function X(a){if(a.m)return a.m;var c="https://www.youtube.com/embed/"+encodeURIComponent(a.g||"")+"?enablejsapi=1",b=x(a.element);"autoplay"in b&&(delete b.autoplay,w().error("AMP-YOUTUBE","Use autoplay attribute instead of data-param-autoplay"));"playsinline"in b||(b.playsinline="1");var d=a.element.hasAttribute("autoplay");d&&("iv_load_policy"in b||(b.iv_load_policy="3"),b.playsinline="1");var e=[],f;for(f in b){var g=b[f];if(null!=g)if(Array.isArray(g))for(var h=0;h<g.length;h++){var l=g[h];e.push(encodeURIComponent(f)+
"="+encodeURIComponent(l))}else e.push(encodeURIComponent(f)+"="+encodeURIComponent(g))}if(b=e.join("&"))c=c.split("#",2),f=c[0].split("?",2),b=f[0]+(f[1]?"?"+f[1]+"&"+b:"?"+b),c=b+=c[1]?"#"+c[1]:"";return a.m=c}
k.layoutCallback=function(){var a=this,c=this.element.ownerDocument.createElement("iframe"),b=X(this);c.setAttribute("frameborder","0");c.setAttribute("allowfullscreen","true");c.src=b;this.applyFillContent(c);this.element.appendChild(c);this.a=c;this.win.addEventListener("message",function(b){if("https://www.youtube.com"==b.origin&&b.source==a.a.contentWindow&&b.data&&("[object Object]"===t.call(b.data)||0==b.data.indexOf("{"))){var c;if("[object Object]"===t.call(b.data))c=b.data;else a:{try{c=
JSON.parse(b.data);break a}catch(f){}c=void 0}b=c;void 0!==b&&("onReady"==b.event?(a.element.dispatchCustomEvent("load"),a.w(a.a)):"infoDelivery"==b.event&&b.info&&void 0!==b.info.playerState?(a.h=b.info.playerState,2==a.h?a.element.dispatchCustomEvent("pause"):1==a.h&&a.element.dispatchCustomEvent("play")):"infoDelivery"==b.event&&b.info&&void 0!==b.info.muted&&a.j!=b.info.muted&&(a.j=b.info.muted,a.element.dispatchCustomEvent(a.j?"muted":"unmuted")))}});return this.loadPromise(c).then(function(){a.a.contentWindow.postMessage(JSON.stringify({event:"listening"}),
"*")}).then(function(){return a.l})};k.pauseCallback=function(){this.a&&this.a.contentWindow&&1==this.h&&this.pause()};k.mutatedAttributesCallback=function(a){void 0!==a["data-videoid"]&&(this.g=Y(this),this.a&&Z(this,"loadVideoById",[this.g]))};function Y(a){return w().assert(a.element.getAttribute("data-videoid"),"The data-videoid attribute is required for <amp-youtube> %s",a.element)}
function Z(a,c,b){a.l.then(function(){if(a.a&&a.a.contentWindow){var d=JSON.stringify({event:"command",func:c,args:b||""});a.a.contentWindow.postMessage(d,"*")}})}
function aa(a){var c=a.element.ownerDocument.createElement("img"),b=a.g||"";I(c,{"object-fit":"cover",visibility:"hidden"});c.src="https://i.ytimg.com/vi/"+encodeURIComponent(b)+"/sddefault.jpg#404_is_fine";c.setAttribute("placeholder","");c.setAttribute("referrerpolicy","origin");a.applyFillContent(c);a.element.appendChild(c);a.loadPromise(c).then(function(){if(120==c.naturalWidth&&90==c.naturalHeight)throw Error("sddefault.jpg is not found");}).catch(function(){c.src="https://i.ytimg.com/vi/"+encodeURIComponent(b)+
"/hqdefault.jpg";return a.loadPromise(c)}).then(function(){I(c,{visibility:""})})}k.supportsPlatform=function(){return!0};k.isInteractive=function(){return!0};k.play=function(){Z(this,"playVideo")};k.pause=function(){Z(this,"pauseVideo")};k.mute=function(){Z(this,"mute")};k.unmute=function(){Z(this,"unMute")};k.showControls=function(){};k.hideControls=function(){};AMP.registerElement("amp-youtube",W);
})});
//# sourceMappingURL=amp-youtube-0.1.js.map

